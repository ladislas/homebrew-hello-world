# File: .azure-ci/setup-ci-env.yml

parameters:
   xcode: 'Xcode_10.2'

steps:

  - bash: |
      set -e
      sudo xcode-select --switch /Applications/$XCODE_VERSION.app/Contents/Developer
      brew update
    displayName: Setup CI Environment
    env:
      XCODE_VERSION: ${{ parameters.xcode }}

  - bash: |
      HOMEBREW_TAP_DIR="/usr/local/Homebrew/Library/Taps/$(github_user)/$(github_tap_repo)"
      mkdir -p "$HOMEBREW_TAP_DIR"
      rm -rf "$HOMEBREW_TAP_DIR"
      ln -s "$PWD" "$HOMEBREW_TAP_DIR"
    displayName: Install tap
